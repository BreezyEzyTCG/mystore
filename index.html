<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Pok√©mon Card Store</title>
<style>
  :root{
    --icon-color-default:#ddeaef;
    --icon-color-active:#789cac;
    --shell:#58747c;
    --fg:#ffffff;
    --chip-bg:#072a54;
    --chip-fg:#fff;
    --accent:#ef4444;
  }
  *,*::before,*::after{ box-sizing:border-box; }
  body{ font-family:Arial,sans-serif; margin:0; background:#f0f4f8; }
  .site-shell{ position:sticky; top:0; z-index:20; background:var(--shell); box-shadow:0 2px 10px rgba(0,0,0,.08); }
  .shell-pad{ padding:10px 12px 0; }
  .hero{ position:relative; height:clamp(160px, 28vw, 260px); border-radius:14px; overflow:hidden; background-image:url("assets/images/Breezy%20Banner.png"); background-size:cover; background-position:center 30%; }
  .hero::before{ content:""; position:absolute; inset:0; background:linear-gradient(to bottom, rgba(0,0,0,.25), rgba(0,0,0,.25)); pointer-events:none; }
  .topbar{ position:absolute; top:10px; right:12px; display:flex; align-items:center; gap:.5rem; z-index:5; }
  .cart-link{ position:relative; display:inline-flex; align-items:center; gap:.5rem; color:var(--chip-fg); text-decoration:none; background:var(--chip-bg); padding:.55rem .85rem; border-radius:.7rem; font-weight:700; white-space:nowrap; }
  .cart-link img{ width:20px; height:20px; filter: invert(98%) sepia(1%) saturate(76%) hue-rotate(180deg) brightness(104%) contrast(95%); }
  .cart-count{ position:absolute; top:-6px; right:-6px; min-width:10px; height:20px; padding:0 6px; background:#1bb9df; color:#f5f5f5; border:2px solid #ffffff; border-radius:999px; font-size:.75rem; display:flex; align-items:center; justify-content:center; font-weight:800; }
  .brand-center{ position:absolute; inset:0; z-index:2; display:flex; align-items:center; justify-content:center; text-align:center; color:var(--fg); pointer-events:none; }
  .brand-title{ margin:0; line-height:1.1; font-weight:800; font-size:clamp(1.6rem, 5.2vw, 2.6rem); text-shadow:0 2px 10px rgba(0,0,0,.35); }
  .brand-subtitle{ margin:.35rem 0 0 0; font-size:clamp(.95rem, 3vw, 1.2rem); text-shadow:0 1px 6px rgba(0,0,0,.35); }
  .filter-bar{ background:var(--shell); padding:12px 12px 14px; }
  .filter-grid{ max-width:1200px; margin:0 auto; display:grid; gap:0.5rem; grid-template-columns: repeat(4, minmax(0, 1fr)); align-items:center; }
  .filter-grid select, .filter-grid input[type="text"]{ width:100%; padding:0.6rem 0.7rem; border-radius:10px; border:1px solid rgba(255,255,255,.3); background:#fff; color:#111; }
  #search{ grid-column:1 / -1; }
  @media (max-width:1023.98px){ .filter-grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); } }
  .controls{ display:flex; justify-content:flex-end; align-items:center; gap:0.75rem; margin:0.75rem auto 0; max-width:1200px; padding:0 1rem; }
  .grid-toggle{ display:flex; gap:0.5rem; }
  .layout-button{ background:transparent; border:none; padding:0.5rem; cursor:pointer; }
  .layout-button svg{ width:24px; height:24px; fill:var(--icon-color-default); }
  .layout-button.active svg{ fill:var(--icon-color-active); }
  .card-container{ display:grid; gap:1.5rem; max-width:1200px; margin:1.25rem auto 2rem; padding:0 1rem; }
  .card-container.grid-1{ grid-template-columns:repeat(1,1fr); }
  .card-container.grid-2{ grid-template-columns:repeat(2,1fr); }
  .card-container.grid-3{ grid-template-columns:repeat(3,1fr); }
  .card{ background:#fff; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,.08); overflow:hidden; display:flex; flex-direction:column; padding:1rem; text-align:center; }
  .card img{ width:100%; aspect-ratio:4/3; object-fit:contain; margin-bottom:0.5rem; }
  .badge{ position:absolute; top:0.5rem; left:0.5rem; padding:5px 10px; font-size:0.75rem; font-weight:bold; border-radius:4px; text-transform:uppercase; }
  .badge.sale{ background:#e02424; color:#fff; }
  .badge.popular{ background:#ffcc00; color:#000; }
  .badge.new{ background:#2fbf71; color:#f8f9fb; }
  button[disabled]{ background:#cbd5e1; color:#6b7280; cursor:not-allowed; }
  #toast{ display:none; position:fixed; bottom:10px; right:10px; background:#e31996; color:#f5f5f5; padding:10px 15px; border-radius:5px; z-index:1000; opacity:0; transition:opacity .5s ease; }
  #toast.show{ display:block; opacity:1; }
</style>
</head>
<body>

<div class="site-shell">
  <div class="shell-pad">
    <div class="hero">
      <div class="topbar">
        <a class="cart-link" href="cart.html"><img src="assets/images/cart-3-svgrepo-com.svg"/><span class="cart-count" id="cartCount">0</span></a>
      </div>
      <div class="brand-center"><div><h1 class="brand-title">BreezyEzyTCG</h1><p class="brand-subtitle"><strong>Collectibles Store</strong></p></div></div>
    </div>
  </div>
  <div class="filter-bar">
    <div class="filter-grid">
      <input type="text" id="search" placeholder="Search..." oninput="applyFilters()"/>
      <select id="category-filter" onchange="onCategoryChange()"><option value="all">All Categories</option></select>
      <select id="subcategory-filter" onchange="applyFilters()"><option value="all">All Subcategories</option></select>
      <select id="rarity-filter" onchange="applyFilters()"><option value="all">All Rarity</option></select>
      <select id="condition-filter" onchange="applyFilters()"><option value="all">All Conditions</option></select>
    </div>
  </div>
</div>

<div class="container-panel">
  <div class="controls">
    <div class="grid-toggle">
      <button class="layout-button single" type="button" onclick="setGridView(1)">1</button>
      <button class="layout-button double active" type="button" onclick="setGridView(2)">2</button>
      <button class="layout-button triple" type="button" onclick="setGridView(3)">3</button>
    </div>
  </div>
  <div class="card-container grid-2"></div>
</div>

<div id="toast"></div>

<script>
let allProducts = [];
const SHEET_CSV = "YOUR_SHEET_CSV_LINK";

function safeNumber(v,f=0){ return Number.isFinite(+v)?+v:f; }
function getCart(){ try{return JSON.parse(localStorage.getItem("cart")||"[]");}catch{return[];} }
function getCartCount(){ return getCart().reduce((s,i)=>s+safeNumber(i.quantity,0),0); }
function updateCartCount(){ document.getElementById("cartCount").textContent=getCartCount(); }
function showToast(msg,duration=3000){ const t=document.getElementById("toast"); t.textContent=msg; t.classList.add("show"); setTimeout(()=>t.classList.remove("show"),duration); }

function addToCart(name, price, image_url){
  const cart = getCart();
  const found = cart.find(i => i.name === name);
  if(found) found.quantity++; else cart.push({ name, price, quantity:1, image:image_url });
  localStorage.setItem("cart", JSON.stringify(cart));
  updateCartCount(); showToast(`${name} added to cart!`);
}

async function fetchInventoryFromSheet(){
  const res = await fetch(SHEET_CSV);
  const csv = await res.text();
  const rows = csv.trim().split("\n").map(r => r.split(","));
  rows.shift(); // remove header
  allProducts = rows.map(r => ({
    name: r[0],
    price: safeNumber(r[1]),
    stock: safeNumber(r[2]),
    image_url: r[3],
    category: r[4],
    subcategory: r[5],
    rarity: r[6],
    condition: r[7],
    badge: r[8],
    series: r[9] || ""
  }));
  renderStore(allProducts);
}

function getBadgeInfo(raw){
  if(!raw) return null;
  const t=raw.toLowerCase();
  if(["sale","sales"].includes(t)) return {cls:"sale",label:"SALE"};
  if(t==="new") return {cls:"new",label:"NEW"};
  if(["popular","hot"].includes(t)) return {cls:"popular",label:"POPULAR"};
  return null;
}

function renderStore(list){
  const c = document.querySelector(".card-container");
  c.innerHTML = "";
  list.forEach(p=>{
    const stock = p.stock;
    const price = p.price;
    const badge = getBadgeInfo(p.badge);
    const card = document.createElement("div");
    card.className="card";
    card.innerHTML = `
      ${badge ? `<div class="badge ${badge.cls}">${badge.label}</div>` : ``}
      <img src="${p.image_url}" alt="${p.name}"/>
      <h3>${p.name}</h3>
      <p><em>${p.series}</em></p>
      <p>$${price.toFixed(2)}</p>
      <p>Rarity: ${p.rarity||""}</p>
      <p>Condition: ${p.condition||""}</p>
      <p>Stock: ${stock}</p>
      <button ${stock<=0?'disabled':''} onclick="addToCart('${p.name}',${price},'${p.image_url}')">${stock<=0?'Out of Stock':'Add to Cart'}</button>
    `;
    c.appendChild(card);
  });
}

fetchInventoryFromSheet();
updateCartCount();
</script>

</body>
</html>
